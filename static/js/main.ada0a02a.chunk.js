(this["webpackJsonpvoting-app-frontend"]=this["webpackJsonpvoting-app-frontend"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(77),s=n.n(r),o=n(11),i=n.n(o),l=n(16),j=n(4),u=n(12),b=n(18),d=n(113),h=n(122),p=n(116),O=n(130),x=n(124),g=n(131),m=n(114),f=n(115),v=Object(c.createContext)(null),y=n(2),k=function(){var e=Object(c.useContext)(v).auth,t=Object(c.useState)([]),n=Object(j.a)(t,2),a=n[0],r=n[1];Object(c.useEffect)((function(){Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/polls");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r(n);case 7:case"end":return e.stop()}}),e)})))()}),[]);return Object(y.jsx)(y.Fragment,{children:e.user?Object(y.jsxs)(d.a,{children:[Object(y.jsxs)(m.a,{as:"h2",size:"large",mb:5,children:["Welcome ",e.user]}),Object(y.jsx)(d.a,{children:a.length?Object(y.jsx)(f.a,{templateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"5",children:a.map((function(e){var t=e.id,n=e.question,c=e.poll_count;return Object(y.jsx)(b.b,{to:"/poll/".concat(t),children:Object(y.jsxs)(d.a,{background:"#f2f9e3",padding:3,borderRadius:5,fontWeight:"bold",children:[Object(y.jsx)("p",{children:n}),Object(y.jsx)("p",{children:c})]})})}))}):Object(y.jsx)(p.a,{height:"65vh",children:Object(y.jsx)(m.a,{as:"h2",size:"large",children:"No polls"})})})]}):Object(y.jsx)(d.a,{children:Object(y.jsxs)(m.a,{as:"h2",size:"large",children:["You must be logged in. Please ",Object(y.jsx)(b.b,{style:{textDecoration:"underline"},to:"/login",children:"Log in"}),"."]})})})},S=n(39),w=n(61),C=n(128),z=n(129),T=n(83),F=function(){var e=Object(c.useContext)(v).auth,t=Object(u.g)().id,n=Object(u.f)(),a=Object(c.useState)(),r=Object(j.a)(a,2),s=r[0],o=r[1],h=Object(c.useState)(!0),p=Object(j.a)(h,2),O=p[0],g=p[1],f=Object(c.useState)(),k=Object(j.a)(f,2),F=k[0],J=k[1],P=Object(c.useState)(!1),N=Object(j.a)(P,2),I=N[0],A=N[1],L=Object(c.useState)(),W=Object(j.a)(L,2),q=W[0],E=W[1];Object(c.useEffect)((function(){e.user||n("/login"),Object(l.a)(i.a.mark((function e(){var n,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/poll/".concat(t));case 2:return n=e.sent,e.next=5,fetch("https://tva-backend.herokuapp.com/poll/".concat(t,"/voted"),{credentials:"include"});case 5:return c=e.sent,e.next=8,n.json();case 8:return a=e.sent,e.next=11,c.json();case 11:e.sent.success&&A(!0),a&&o(a[0]),g(!1);case 15:case"end":return e.stop()}}),e)})))()}),[]),Object(c.useEffect)((function(){var e=function(){var e=Object(l.a)(i.a.mark((function e(){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/poll/".concat(t,"/results"),{credentials:"include"});case 2:return n=e.sent,e.next=5,n.json();case 5:c=e.sent,E(c);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[I,A]);return Object(y.jsx)(y.Fragment,{children:O?"":Object(y.jsxs)(d.a,{children:[Object(y.jsx)(m.a,{as:"h2",size:"3xl",mb:10,textAlign:"center",children:s.question}),I?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(d.a,{mb:10,background:"#b7d2d9",padding:"71px",borderRadius:"10px",children:function(){var e=JSON.parse(s.options),t={label:"# of votes",data:JSON.parse(q[0].options_weight)},n={labels:e,datasets:[Object(S.a)(Object(S.a)({},t),{},{backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1})]};return Object(y.jsx)(T.a,{data:n,options:{indexAxis:"y"}})}()}),Object(y.jsx)(d.a,{textAlign:"right",children:Object(y.jsx)(b.b,{to:"/",children:Object(y.jsx)(x.a,{colorScheme:"yellow",children:"Back"})})})]}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(w.a,{onChange:function(e){return function(e){J(parseInt(e))}(e)},value:F,mb:10,children:Object(y.jsx)(C.a,{children:JSON.parse(s.options).map((function(e,t){return Object(y.jsx)(z.a,{size:"lg",colorScheme:"yellow",value:t,children:e})}))})}),Object(y.jsx)(x.a,{onClick:function(){Object(l.a)(i.a.mark((function n(){var c,a,r,o;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!s){n.next=16;break}return c=JSON.parse(s.options_weight),a={choice:F,pollCount:null===s||void 0===s?void 0:s.total_count,optionsWeight:c},n.next=5,fetch("https://tva-backend.herokuapp.com/poll/".concat(t,"/submit"),{method:"POST",credentials:"include",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});case 5:return r=n.sent,n.next=8,fetch("https://tva-backend.herokuapp.com/poll/".concat(t,"/submit-user"),{method:"POST",credentials:"include",body:JSON.stringify({userId:e.userId}),headers:{"Content-Type":"application/json"}});case 8:return o=n.sent,n.next=11,r.json();case 11:return n.sent,n.next=14,o.json();case 14:n.sent,A(!0);case 16:case"end":return n.stop()}}),n)})))()},colorScheme:"yellow",children:"Vote"})]})]})})},J=n(6),P=n(119),N=n(120),I=n(121),A=n(85),L=n(80),W=function(){var e=Object(c.useContext)(v).auth,t=Object(u.f)(),n=Object(c.useState)(["option","option"]),a=Object(j.a)(n,2),r=a[0],s=a[1],o=Object(c.useState)(""),b=Object(j.a)(o,2),d=b[0],h=b[1],O=Object(c.useState)(!1),g=Object(j.a)(O,2),f=g[0],k=g[1];Object(c.useEffect)((function(){e.user||t("/login")}));var S=Object(L.a)(),w=S.register,C=S.handleSubmit,z=S.errors;var T=C((function(e){for(var t=[],n=0,c=Object.values(e);n<c.length;n++){var a=c[n];t.push(a)}0===d.length?k(!0):(k(!1),function(e,t){F.apply(this,arguments)}(d,t))}));function F(){return F=Object(l.a)(i.a.mark((function e(n,c){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={question:n,options:c},e.next=3,fetch("https://tva-backend.herokuapp.com/poll/create",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});case 3:return r=e.sent,e.next=6,r.json();case 6:e.sent,t("/");case 8:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}return Object(y.jsxs)(p.a,{direction:"column",align:"center",children:[Object(y.jsx)(m.a,{as:"h2",size:"large",children:"Create a new poll"}),Object(y.jsxs)(p.a,{direction:"column",w:"30rem",children:[Object(y.jsx)(P.a,{my:"1rem",placeholder:"Write your question here",onChange:function(e){h(e.target.value)}}),f&&Object(y.jsx)(N.a,{color:"red",children:"You need a Question"}),Object(y.jsxs)("form",{onSubmit:T,children:[r.map((function(e,t){return Object(y.jsx)(I.a,{my:"1rem",placeholder:"Option ".concat(t+1),type:"text",ref:w({required:!0}),name:"option ".concat(t+1," ")})})),z.option&&Object(y.jsx)(N.a,{children:" hallo"}),Object(y.jsxs)(p.a,{justify:"center",my:"1rem",children:[Object(y.jsx)(x.a,{mx:"1rem",variant:"ghost",leftIcon:Object(y.jsx)(A.a,{}),onClick:function(){var e=[].concat(Object(J.a)(r),["option"]);s(e)},children:"Add an option"}),Object(y.jsx)(x.a,{mx:"1rem",type:"submit",children:"Submit"})]})]})]})]})},q=function(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),s=Object(j.a)(r,2),o=s[0],d=s[1],h=Object(c.useState)(!1),O=Object(j.a)(h,2),g=O[0],f=O[1],k=Object(c.useContext)(v),S=(k.auth,k.setAuth),w=Object(u.f)();function C(){return(C=Object(l.a)(i.a.mark((function e(){var t,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>0&&o.length>0)){e.next=11;break}return t={username:n,password:o},e.next=4,fetch("https://tva-backend.herokuapp.com/signup",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"},credentials:"include"});case 4:return c=e.sent,e.next=7,c.json();case 7:e.sent.success?(S({user:t.username}),w("/login",{replace:!0})):f(!0),e.next=12;break;case 11:f(!0);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(p.a,{w:"100%",direction:"column",align:"center",children:[Object(y.jsx)(m.a,{as:"h2",size:"large",children:"Signup"}),Object(y.jsxs)(p.a,{w:"50%",direction:"column",align:"center",pos:"relative",children:[Object(y.jsx)(I.a,{my:"1rem",placeholder:"Username",size:"lg",onChange:function(e){a(e.target.value)},background:"white",required:!0}),Object(y.jsx)(I.a,{my:"1rem",placeholder:"Password",size:"lg",type:"password",background:"white",onChange:function(e){d(e.target.value)}}),Object(y.jsxs)(p.a,{align:"center",children:[Object(y.jsx)(N.a,{pos:"absolute",left:"0",children:Object(y.jsx)(b.b,{to:"/login",children:"Go back to Login"})}),Object(y.jsx)(x.a,{my:"1rem",w:"8rem",type:"submit",onClick:function(){return C.apply(this,arguments)},children:"signup"})]}),g&&Object(y.jsx)(N.a,{children:"Signup Failed"})]})]})},E=function(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),s=Object(j.a)(r,2),o=s[0],d=s[1],h=Object(c.useState)(!1),O=Object(j.a)(h,2),g=O[0],f=O[1],k=Object(c.useContext)(v),S=(k.auth,k.setAuth),w=Object(u.f)();function C(){return(C=Object(l.a)(i.a.mark((function e(){var t,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={username:n,password:o},e.next=3,fetch("https://tva-backend.herokuapp.com/login",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"},credentials:"include"});case 3:return c=e.sent,e.next=6,c.json();case 6:(a=e.sent).success?(S({user:t.username,userId:a.userId}),w("/",{replace:!0})):f(!0);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(p.a,{w:"100%",direction:"column",align:"center",children:[Object(y.jsx)(m.a,{as:"h2",size:"large",children:"Login"}),Object(y.jsxs)(p.a,{w:"50%",direction:"column",align:"center",children:[Object(y.jsx)(I.a,{my:"1rem",placeholder:"Username",size:"lg",onChange:function(e){a(e.target.value)},background:"white"}),Object(y.jsx)(I.a,{my:"1rem",placeholder:"Password",size:"lg",type:"password",onChange:function(e){d(e.target.value)},background:"white"}),Object(y.jsxs)(p.a,{align:"center",children:[Object(y.jsx)(x.a,{my:"1rem",mr:"1rem",w:"50%",type:"submit",colorScheme:"whiteAlpha",onClick:function(){return C.apply(this,arguments)},children:"Log In"}),Object(y.jsx)(N.a,{children:"or"}),Object(y.jsx)(x.a,{ml:"1rem",colorScheme:"facebook",children:Object(y.jsx)(b.b,{to:"/signup",children:"signup"})})]}),g&&Object(y.jsx)(N.a,{children:"Login Failed"})]})]})},_=Object(y.jsxs)(u.c,{children:[Object(y.jsx)(u.a,{path:"/",element:Object(y.jsx)(k,{})}),Object(y.jsx)(u.a,{path:"/poll/:id",element:Object(y.jsx)(F,{})}),Object(y.jsx)(u.a,{path:"/new",element:Object(y.jsx)(W,{})}),Object(y.jsx)(u.a,{path:"/signup",element:Object(y.jsx)(q,{})}),Object(y.jsx)(u.a,{path:"/login",element:Object(y.jsx)(E,{})})]});var B=function(){var e=Object(c.useState)({user:null}),t=Object(j.a)(e,2),n=t[0],a=t[1],r=Object(u.f)(),s=Object(c.useState)(!0),o=Object(j.a)(s,2),m=o[0],f=o[1];return Object(c.useEffect)((function(){Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/auth",{credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a(n),f(!1);case 8:case"end":return e.stop()}}),e)})))()}),[]),Object(y.jsx)(y.Fragment,{children:m?Object(y.jsx)(d.a,{}):Object(y.jsxs)(h.a,{maxW:"container.xl",children:[Object(y.jsx)(d.a,{paddingTop:5,paddingBottom:5,children:Object(y.jsxs)(p.a,{justifyContent:"space-between",background:"#7b8e93",padding:"10px 20px",borderRadius:"10px",alignItems:"center",children:[Object(y.jsx)(d.a,{children:Object(y.jsxs)(b.b,{to:"/",style:{fontWeight:"bold"},children:[Object(y.jsx)(O.a,{src:"https://emojis.slackmojis.com/emojis/images/1534453840/4524/zlatan_ibrahimovic.png?1534453840",display:"inline-block",height:10}),"Zultan's Voting App"]})}),Object(y.jsx)(d.a,{children:n.user?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(b.b,{to:"/new",style:{marginRight:10},children:Object(y.jsx)(x.a,{colorScheme:"linkedin",size:"xs",children:"new poll"})}),Object(y.jsx)(x.a,{size:"xs",colorScheme:"whatsapp",onClick:function(){Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/signout",{credentials:"include",method:"POST",body:JSON.stringify({})});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent,a({user:null});case 7:case"end":return e.stop()}}),e)})))(),r("/")},children:"sign out"})]}):Object(y.jsxs)(g.b,{children:[Object(y.jsx)(g.a,{mr:4,listStyleType:"none",display:"inline",children:Object(y.jsx)(b.b,{to:"/login",children:Object(y.jsx)(x.a,{size:"xs",colorScheme:"whatsapp",children:"login"})})}),Object(y.jsx)(g.a,{listStyleType:"none",display:"inline",children:Object(y.jsx)(b.b,{to:"/signup",children:Object(y.jsx)(x.a,{colorScheme:"linkedin",size:"xs",children:"sign up"})})})]})})]})}),Object(y.jsx)(v.Provider,{value:{auth:n,setAuth:a},children:Object(y.jsx)(d.a,{mt:100,children:_})})]})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,132)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))},M=n(125),D=n(123),U=Object(D.a)({initialColorMode:"dark",useSystemColorMode:!1,styles:{global:{body:{background:"#93a4a8",color:"#322727"}}}});s.a.render(Object(y.jsxs)(a.a.StrictMode,{children:[Object(y.jsx)(b.a,{children:Object(y.jsx)(M.a,{theme:U,children:Object(y.jsx)(B,{})})}),","]}),document.getElementById("root")),R()}},[[103,1,2]]]);
//# sourceMappingURL=main.ada0a02a.chunk.js.map
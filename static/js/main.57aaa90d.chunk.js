(this["webpackJsonpvoting-app-frontend"]=this["webpackJsonpvoting-app-frontend"]||[]).push([[0],{85:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),r=n(65),a=n.n(r),i=n(19),j=n.n(i),l=n(27),o=n(4),u=n(6),b=n(12),h=n(100),d=n(97),O=n(95),x=n(101),p=n(96),g=n(105),f=Object(c.createContext)(null),m=n(2),v=function(){var e=Object(c.useContext)(f).auth,t=Object(c.useState)([]),n=Object(o.a)(t,2),s=n[0],r=n[1];Object(c.useEffect)((function(){Object(l.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/polls");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,console.log(n),r(n);case 8:case"end":return e.stop()}}),e)})))()}),[]);return console.log(e),Object(m.jsx)(m.Fragment,{children:e.user?Object(m.jsxs)(O.a,{children:[Object(m.jsxs)(p.a,{as:"h2",size:"large",children:["Welcome ",e.user]}),Object(m.jsx)(O.a,{children:s.length?Object(m.jsx)(g.a,{templateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"5",children:s.map((function(e){var t=e.id,n=e.question,c=e.poll_count;return Object(m.jsx)(b.b,{to:"/poll/".concat(t),children:Object(m.jsxs)(O.a,{background:"#3e5177",padding:3,borderRadius:5,fontWeight:"bold",children:[Object(m.jsx)("p",{children:n}),Object(m.jsx)("p",{children:c})]})})}))}):Object(m.jsx)(d.a,{height:"65vh",children:Object(m.jsx)(p.a,{as:"h2",size:"large",children:"No polls"})})})]}):Object(m.jsx)(O.a,{children:Object(m.jsxs)(p.a,{as:"h2",size:"large",children:["You must be logged in. Please ",Object(m.jsx)(b.b,{style:{textDecoration:"underline"},to:"/login",children:"Log in"}),"."]})})})},w=function(){var e=Object(c.useContext)(f).auth,t=Object(u.f)();return Object(c.useEffect)((function(){e.user||t("/login")})),Object(m.jsx)(O.a,{children:Object(m.jsx)(p.a,{as:"h2",size:"large",children:"View Poll"})})},k=function(){var e=Object(c.useContext)(f).auth,t=Object(u.f)();return Object(c.useEffect)((function(){e.user||t("/login")})),Object(m.jsx)(O.a,{children:Object(m.jsx)(p.a,{as:"h2",size:"large",children:"NewPoll"})})},y=function(){return Object(m.jsx)(O.a,{children:Object(m.jsx)(p.a,{as:"h2",size:"large",children:"Signup"})})},C=n(102),S=n(99),z=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(o.a)(r,2),i=a[0],h=a[1],O=Object(c.useState)(!1),g=Object(o.a)(O,2),v=g[0],w=g[1],k=Object(c.useContext)(f),y=(k.auth,k.setAuth),z=Object(u.f)();function P(){return(P=Object(l.a)(j.a.mark((function e(){var t,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={username:n,password:i},e.next=3,fetch("https://tva-backend.herokuapp.com/login",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"},credentials:"include"});case 3:return c=e.sent,e.next=6,c.json();case 6:e.sent.success?(y({user:t.username}),z("/",{replace:!0})):w(!0);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsxs)(d.a,{w:"100%",direction:"column",align:"center",children:[Object(m.jsx)(p.a,{as:"h2",size:"large",children:"Login"}),Object(m.jsxs)(d.a,{w:"50%",direction:"column",align:"center",children:[Object(m.jsx)(C.a,{my:"1rem",placeholder:"Username",size:"lg",onChange:function(e){s(e.target.value)}}),Object(m.jsx)(C.a,{my:"1rem",placeholder:"Password",size:"lg",type:"password",onChange:function(e){h(e.target.value)}}),Object(m.jsxs)(d.a,{align:"center",children:[Object(m.jsx)(x.a,{my:"1rem",mr:"1rem",w:"50%",type:"submit",onClick:function(){return P.apply(this,arguments)},children:"Log In"}),Object(m.jsx)(S.a,{children:"or"}),Object(m.jsx)(x.a,{ml:"1rem",children:Object(m.jsx)(b.b,{to:"/signup",children:"signup"})})]}),v&&Object(m.jsx)(S.a,{children:"Login Failed"})]})]})},P=Object(m.jsxs)(u.c,{children:[Object(m.jsx)(u.a,{path:"/",element:Object(m.jsx)(v,{})}),Object(m.jsx)(u.a,{path:"/poll/:id",element:Object(m.jsx)(w,{})}),Object(m.jsx)(u.a,{path:"/new",element:Object(m.jsx)(k,{})}),Object(m.jsx)(u.a,{path:"/signup",element:Object(m.jsx)(y,{})}),Object(m.jsx)(u.a,{path:"/login",element:Object(m.jsx)(z,{})})]});var F=function(){var e=Object(c.useState)({user:null}),t=Object(o.a)(e,2),n=t[0],s=t[1],r=Object(u.f)();return Object(c.useEffect)((function(){Object(l.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/auth",{credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,s(n);case 7:case"end":return e.stop()}}),e)})))()}),[]),console.log(n.user),Object(m.jsxs)(h.a,{maxW:"container.xl",children:[Object(m.jsx)("nav",{children:Object(m.jsxs)(d.a,{justifyContent:"space-between",children:[Object(m.jsx)(O.a,{children:"Voting App"}),Object(m.jsx)(O.a,{children:n.user?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(b.b,{to:"/new",style:{marginRight:10},children:Object(m.jsx)(x.a,{colorScheme:"linkedin",size:"xs",children:"new poll"})}),Object(m.jsx)(x.a,{size:"xs",colorScheme:"whatsapp",onClick:function(){Object(l.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://tva-backend.herokuapp.com/signout",{credentials:"include",method:"POST",body:JSON.stringify({})});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent,s({user:null});case 7:case"end":return e.stop()}}),e)})))(),r("/")},children:"sign out"})]}):Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsx)(b.b,{to:"/signup",children:"signup"})}),Object(m.jsx)("li",{children:Object(m.jsx)(b.b,{to:"/login",children:"login"})})]})})]})}),Object(m.jsx)(f.Provider,{value:{auth:n,setAuth:s},children:Object(m.jsx)(O.a,{children:P})})]})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,106)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),s(e),r(e),a(e)}))},E=n(103);a.a.render(Object(m.jsxs)(s.a.StrictMode,{children:[Object(m.jsx)(b.a,{children:Object(m.jsx)(E.a,{children:Object(m.jsx)(F,{})})}),","]}),document.getElementById("root")),L()}},[[85,1,2]]]);
//# sourceMappingURL=main.57aaa90d.chunk.js.map